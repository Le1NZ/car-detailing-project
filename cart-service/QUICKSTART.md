# Cart Service - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ó–∞–ø—É—Å–∫](#–∑–∞–ø—É—Å–∫)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.11+
- Docker (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- curl –∏–ª–∏ Postman –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–µ—Ä–≤–∏—Å–∞
cd /Users/fr4lzen/Documents/–º–∏—Ä—ç–∞/–º–∏–∫—Ä–æ—Å—ã/–ø—Ä7/project/cart-service

# –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# –∏–ª–∏
venv\Scripts\activate     # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt
```

---

## –ó–∞–ø—É—Å–∫

### –í–∞—Ä–∏–∞–Ω—Ç 1: –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å–∫ —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
uvicorn app.main:app --host 0.0.0.0 --port 8004 --reload

# –ò–ª–∏ –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Python
python -m app.main
```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞: http://localhost:8004

### –í–∞—Ä–∏–∞–Ω—Ç 2: Docker

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t cart-service .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -p 8004:8004 cart-service
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: Docker Compose

```bash
# –ò–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
docker-compose up cart-service
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### Health Check

```bash
curl http://localhost:8004/health
```

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "status": "healthy",
  "service": "cart-service",
  "version": "1.0.0"
}
```

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- Swagger UI: http://localhost:8004/docs
- ReDoc: http://localhost:8004/redoc

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä–∏—Ç –≤—Å–µ endpoint'—ã:

```bash
chmod +x test_api.sh
./test_api.sh
```

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 1. –ü–æ–ª—É—á–∏—Ç—å –ø—É—Å—Ç—É—é –∫–æ—Ä–∑–∏–Ω—É

```bash
curl http://localhost:8004/api/cart
```

–û—Ç–≤–µ—Ç:
```json
{
  "user_id": "12345678-1234-5678-1234-567812345678",
  "items": [],
  "total_price": 0.0
}
```

#### 2. –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É "–ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞"

```bash
curl -X POST http://localhost:8004/api/cart/items \
  -H "Content-Type: application/json" \
  -d '{
    "item_id": "svc_oil_change",
    "type": "service",
    "quantity": 1
  }'
```

–û—Ç–≤–µ—Ç:
```json
{
  "user_id": "12345678-1234-5678-1234-567812345678",
  "items": [
    {
      "item_id": "svc_oil_change",
      "type": "service",
      "name": "–ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞",
      "quantity": 1,
      "price": 2500.0
    }
  ],
  "total_price": 2500.0
}
```

#### 3. –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä "–ú–∞—Å–ª—è–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä"

```bash
curl -X POST http://localhost:8004/api/cart/items \
  -H "Content-Type: application/json" \
  -d '{
    "item_id": "prod_oil_filter",
    "type": "product",
    "quantity": 2
  }'
```

#### 4. –ü–æ–ª—É—á–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É —Å —Ç–æ–≤–∞—Ä–∞–º–∏

```bash
curl http://localhost:8004/api/cart
```

–û—Ç–≤–µ—Ç:
```json
{
  "user_id": "12345678-1234-5678-1234-567812345678",
  "items": [
    {
      "item_id": "svc_oil_change",
      "type": "service",
      "name": "–ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞",
      "quantity": 1,
      "price": 2500.0
    },
    {
      "item_id": "prod_oil_filter",
      "type": "product",
      "name": "–ú–∞—Å–ª—è–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä",
      "quantity": 2,
      "price": 1000.0
    }
  ],
  "total_price": 4500.0
}
```

#### 5. –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã

```bash
curl -X DELETE http://localhost:8004/api/cart/items/prod_oil_filter
```

–û—Ç–≤–µ—Ç: HTTP 204 No Content (–±–µ–∑ —Ç–µ–ª–∞)

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π: –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –Ω–∞ –∑–∞–º–µ–Ω—É –º–∞—Å–ª–∞

```bash
# –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞
curl http://localhost:8004/api/cart

# –®–∞–≥ 2: –î–æ–±–∞–≤–ª—è–µ–º —É—Å–ª—É–≥—É "–ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞"
curl -X POST http://localhost:8004/api/cart/items \
  -H "Content-Type: application/json" \
  -d '{"item_id": "svc_oil_change", "type": "service", "quantity": 1}'

# –®–∞–≥ 3: –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Å–ª—è–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä
curl -X POST http://localhost:8004/api/cart/items \
  -H "Content-Type: application/json" \
  -d '{"item_id": "prod_oil_filter", "type": "product", "quantity": 1}'

# –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä–∑–∏–Ω—É
curl http://localhost:8004/api/cart

# –†–µ–∑—É–ª—å—Ç–∞—Ç: total_price = 3500.00 (2500 + 1000)
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

#### –ü–æ–ø—ã—Ç–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ç–æ–≤–∞—Ä

```bash
curl -X POST http://localhost:8004/api/cart/items \
  -H "Content-Type: application/json" \
  -d '{"item_id": "invalid_item", "type": "service", "quantity": 1}'
```

–û—Ç–≤–µ—Ç: HTTP 404
```json
{
  "detail": "Item 'invalid_item' not found in catalog"
}
```

#### –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ –∫–æ—Ä–∑–∏–Ω–µ

```bash
curl -X DELETE http://localhost:8004/api/cart/items/non_existent
```

–û—Ç–≤–µ—Ç: HTTP 404
```json
{
  "detail": "Item 'non_existent' not found in cart"
}
```

---

## –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –∏ —É—Å–ª—É–≥–∏

| ID | –¢–∏–ø | –ù–∞–∑–≤–∞–Ω–∏–µ | –¶–µ–Ω–∞ |
|---|---|---|---|
| `svc_oil_change` | service | –ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ | 2500.00 |
| `prod_oil_filter` | product | –ú–∞—Å–ª—è–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä | 1000.00 |
| `svc_diagnostics` | service | –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ | 1500.00 |

---

## –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ - –ª–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å

# Docker
docker logs <container_id>

# Docker Compose
docker-compose logs cart-service
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞

```bash
python3 -m py_compile app/**/*.py
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip list
```

---

## –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
–ù–∞–∂–º–∏—Ç–µ `Ctrl+C` –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

### Docker
```bash
docker stop <container_id>
```

### Docker Compose
```bash
docker-compose down
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–ø–∏—Å–∞–Ω—ã –≤ —Ñ–∞–π–ª–∞—Ö:
- `STRUCTURE.txt` - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞
- `README.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `API_EXAMPLES.md` - –ø—Ä–∏–º–µ—Ä—ã –≤—Å–µ—Ö API –≤—ã–∑–æ–≤–æ–≤
- `IMPLEMENTATION_REPORT.md` - –æ—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞
lsof -i :8004

# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É 8004
kill $(lsof -t -i:8004)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞
curl -I http://localhost:8004/health

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥ JSON
curl http://localhost:8004/api/cart | python3 -m json.tool
```

---

## FAQ

**Q: –°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –ø–æ—Ä—Ç 8004 –∑–∞–Ω—è—Ç**
```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å
lsof -i :8004
# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
kill -9 <PID>
```

**Q: –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä–∑–∏–Ω—ã?**
A: –í –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (in-memory). –î–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å–∞.

**Q: –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç?**
A: –ò–∑–º–µ–Ω–∏—Ç–µ `SERVICE_PORT` –≤ `app/config.py` –∏ –∫–æ–º–∞–Ω–¥—É –∑–∞–ø—É—Å–∫–∞.

**Q: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–∞—Ç–∞–ª–æ–≥?**
A: –î–æ–±–∞–≤—å—Ç–µ –∑–∞–ø–∏—Å–∏ –≤ `CATALOG` –≤ —Ñ–∞–π–ª–µ `app/services/cart_service.py`.

**Q: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é?**
A: –ó–∞–º–µ–Ω–∏—Ç–µ `get_user_id()` dependency –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é, –∏–∑–≤–ª–µ–∫–∞—é—â—É—é user_id –∏–∑ JWT —Ç–æ–∫–µ–Ω–∞.

---

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 8004 —Å–≤–æ–±–æ–¥–µ–Ω
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –∞–¥—Ä–µ—Å—É http://localhost:8004/docs

---

**–°–µ—Ä–≤–∏—Å –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!** üöÄ
